<!DOCTYPE html>
<html>
    <head>
        <title>Icebreaker</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <style>
            body {
                font-family: Arial, sans-serif;
                text-align: center;
            }
            h1 {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            .icon {
                margin-right: 5px;
            }
            .container {
                margin: 20px auto;
                max-width: 600px;
            }
            .question-container {
                height: 100px;
                margin-bottom: 20px;
            }
            .question {
                display: flex;
                align-items: center;
                justify-content: center;
                height: 100%;
            }
            .button {
                background-color: #4caf50;
                color: white;
                padding: 10px 20px;
                border: none;
                border-radius: 4px;
                cursor: pointer;
                font-size: 16px;
                margin-top: 10px;
            }
            #selectedUser {
                font-size: 20px;
                margin-top: 10px;
            }
            #userList {
                text-align: left;
                list-style: none;
                padding-left: 0;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <h1><i class="fas fa-users icon"></i>Icebreaker</h1>
            <div class="question-container">
                <div class="question">
                    <p id="generatedQuestion">Welcome! Click the button below to generate an icebreaker question.</p>
                </div>
            </div>
            <button class="button" id="generateButton"><i class="fas fa-arrow-circle-right"></i> Generate Question</button>
            <div>
                <button class="button" id="addUserButton">Add User</button>
                <button class="button" id="selectUserButton">Select User</button>
            </div>
            <p id="selectedUser"></p>
            <h2>User List:</h2>
            <ul id="userList"></ul>
        </div>
        <script>
            var englishQuestions = [
                "If you could have any superpower, what would it be and why?",
                "What is your favorite hobby or pastime?",
                "If you could travel anywhere in the world, where would you go and why?",
                "What is the most memorable concert or live performance you have attended?",
                "If you could meet any historical figure, who would it be and what would you ask them?",
                "What is your favorite book or movie and why?",
                "If you could have dinner with any fictional character, who would it be and why?",
                "What is one thing on your bucket list that you hope to achieve?",
                "If you could learn any new skill instantly, what would it be and why?",
                "What is your favorite way to relax and unwind after a long day?",
                "If you could have a dinner party with three famous people, living or dead, who would you invite?",
                "What is the most adventurous thing you have ever done?",
                "What is your favorite type of cuisine or food?",
                "If you could time travel, would you go to the past or the future? Why?",
                "What is one interesting fact about yourself that not many people know?",
                "What is your favorite season and why?",
                "If you could witness any historical event, which one would you choose and why?",
                "What is the best piece of advice you've ever received?",
                "If you could have any talent or skill, what would it be and why?",
                "What is your favorite outdoor activity or sport?",
                "If you could have a conversation with any animal, which one would you choose and why?",
                "What is your favorite quote or motto that you live by?",
                "If you could have a personal chef, what type of meals would you want them to prepare?",
                "What is one thing you would like to achieve in the next year?",
                "If you had unlimited resources, what kind of philanthropic work would you do?",
                "What is your favorite way to spend a day off?",
                "If you could have any talent in the world, what would you choose?",
                "What is the best vacation you have ever taken?",
                "If you could invite any three people to a dinner party, who would they be?",
                "What is your favorite board game or card game?",
                "If you could live in any fictional world, which one would you choose?",
                "What is your favorite quote or saying?",
                "If you could have a conversation with your younger self, what advice would you give?",
                "What is your favorite type of music and why?",
                "If you could instantly learn any language, which one would you choose?",
                "What is the most memorable gift you have ever received?",
                "If you could have any animal as a pet, what would you choose?",
                "What is your favorite way to stay active and fit?",
                "If you could have a special power, unrelated to superpowers, what would it be?",
                "What is your favorite holiday and why?",
                "If you could witness any historical event, what would you choose?",
                "What is one thing that always brings a smile to your face?",
                "If you could have dinner with any celebrity, who would it be and why?",
                "What is your favorite thing about the city or town you live in?",
                "If you could invent a new technology, what would it do?",
                "What is your favorite quote from a movie or TV show?",
                "If you could have any job in the world for one day, what would it be?",
                "What is one item on your bucket list that you hope to check off soon?",
                "If you could time travel, would you go to the past or the future, and why?",
                "What is one thing you would like to learn or improve upon in the next year?",
            ];
            var portugueseQuestions = [
                "Qual é o seu hobby favorito?",
                "Se você pudesse ter um superpoder, qual seria?",
                "Qual é a sua música favorita para cantar no karaokê?",
                "Qual é o seu livro ou filme favorito?",
                "Se você pudesse viajar para qualquer lugar do mundo, para onde iria?",
                "Qual é a aventura mais emocionante que você já viveu?",
                "Se você pudesse conhecer qualquer figura histórica, quem seria?",
                "Qual é a sua maneira favorita de relaxar após um dia longo?",
                "Qual é o seu sabor de sorvete favorito?",
                "Se você pudesse jantar com qualquer personagem fictício, quem seria?",
                "Qual é a sua estação do ano favorita e por quê?",
                "Se você pudesse aprender qualquer nova habilidade, qual seria?",
                "Qual é a sua citação favorita?",
                "Se você pudesse viajar no tempo, iria para o passado ou para o futuro?",
                "Qual é uma coisa na sua lista de desejos?",
                "Se você pudesse ter qualquer animal como animal de estimação, qual seria?",
                "Qual é o seu tipo de culinária favorito?",
                "Se você pudesse ser um atleta profissional, qual esporte escolheria?",
                "Qual é a sua maneira favorita de se manter ativo?",
                "Se você pudesse ter um jantar com qualquer três pessoas, vivas ou mortas, quem convidaria?",
                "Qual é a sua atividade ao ar livre favorita?",
                "Se você pudesse ter um talento especial, qual seria?",
                "Qual é o seu feriado favorito e por quê?",
                "Se você pudesse ter qualquer emprego por um dia, qual escolheria?",
                "Qual é a sua coisa favorita em si mesmo(a)?",
                "O que você mais gosta de fazer nos fins de semana?",
                "Qual é o seu prato favorito da culinária brasileira?",
                "Se você pudesse viver em qualquer cidade do Brasil, qual escolheria?",
                "Qual é o seu esporte favorito para assistir na televisão?",
                "O que você mais gosta de fazer ao ar livre?",
                "Qual é a sua série de TV favorita?",
                "Se você pudesse ter um superpoder relacionado à comida, qual seria?",
                "Qual é a sua sobremesa favorita?",
                "O que você mais gosta de fazer nas férias?",
                "Se você pudesse ter um animal de estimação incomum, qual escolheria?",
                "Qual é o seu filme brasileiro favorito?",
                "Se você pudesse ter uma casa em qualquer lugar do mundo, onde seria?",
                "Qual é a sua atividade física favorita?",
                "O que você mais gosta de fazer em dias chuvosos?",
                "Se você pudesse aprender um novo idioma, qual escolheria?",
                "Qual é o seu tipo de música favorito?",
                "Se você pudesse ter um poder de cura, qual seria?",
                "Qual é a sua comida favorita para um dia de frio?",
                "Se você pudesse ser um personagem de desenho animado, quem seria?",
                "Qual é o seu destino de viagem dos sonhos?",
                "Se você pudesse ter uma profissão diferente, qual escolheria?",
                "Qual é a sua habilidade culinária favorita?",
                "O que você mais gosta de fazer em seu tempo livre?",
                "Se você pudesse ter um talento artístico, qual seria?",
                "Qual é o seu programa de TV favorito da infância?",
                "Se você pudesse ter um poder mágico, qual seria?",
                "Qual é a sua bebida favorita?",
                "O que você mais gosta de fazer em um dia ensolarado?",
            ];

            var questions = [];

            $(document).ready(function () {
                function getQueryParams() {
                    var params = {};
                    window.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi, function (str, key, value) {
                        params[key] = decodeURIComponent(value);
                    });
                    return params;
                }

                function addUsersFromQueryParam() {
                    var queryParams = getQueryParams();
                    var usersParam = queryParams["users"];
                    if (usersParam) {
                        var userList = $("#userList");
                        var newUsers = usersParam.split(",");
                        $.each(newUsers, function (index, username) {
                            username = username.trim();
                            if (username) {
                                var listItem = $("<li>").text(username);
                                userList.append(listItem);
                            }
                        });
                    }
                }

                addUsersFromQueryParam();

                function getLanguage() {
                    var queryParams = getQueryParams();
                    var language = queryParams["language"];
                    questions = englishQuestions;
                    if (language) {
                        questions = language === "pt" ? portugueseQuestions : englishQuestions;
                    }
                }
                getLanguage();

                $("#generateButton").click(function () {
                    var randomNumber = Math.floor(Math.random() * questions.length);
                    var generatedQuestion = questions[randomNumber];
                    $("#generatedQuestion").text(generatedQuestion);
                });

                $("#addUserButton").click(function () {
                    var usernames = prompt("Enter usernames separated by commas:");
                    if (usernames) {
                        var userList = $("#userList");
                        var newUsers = usernames.split(",").map(function (username) {
                            return username.trim();
                        });

                        newUsers = newUsers.filter(function (username) {
                            return !userList.find("li:contains('" + username + "')").length;
                        });

                        newUsers.forEach(function (username) {
                            var listItem = $("<li>").text(username);
                            userList.append(listItem);
                        });

                        updateURLWithUsers();
                    }
                });

                function updateURLWithUsers() {
                    var userList = $("#userList li");
                    var usernames = userList
                        .map(function () {
                            return $(this).text();
                        })
                        .get()
                        .join(",");

                    var url = window.location.href;
                    var regex = /[?&]users=[^&]+/i;
                    url = url.replace(regex, "");

                    if (usernames) {
                        var separator = url.indexOf("?") === -1 ? "?" : "&";
                        var updatedURL = url + separator + "users=" + encodeURIComponent(usernames);
                        window.history.replaceState({}, "", updatedURL);
                    } else {
                        window.history.replaceState({}, "", url);
                    }
                }

                $("#selectUserButton").click(function () {
                    var userList = $("#userList");
                    var users = userList.find("li");
                    if (users.length > 0) {
                        var selectedUser = users.first().text();
                        $("#selectedUser").text("Selected User: " + selectedUser);
                        users.first().remove();
                    } else {
                        $("#selectedUser").text("No users available.");
                    }
                });
            });
        </script>
    </body>
</html>
